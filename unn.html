<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>科普卢星区战术星图</title>
    <style>
        /* --- 核心字体与基础设置 --- */
        /* 重新引入 Share Tech Mono 以保证纯粹的终端风格 */
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Share+Tech+Mono&display=swap');

        :root {
            /* 泰伦 UI 配色方案 */
            --sc-bg-dark: #05080c;
            --sc-panel-bg: rgba(12, 20, 31, 0.90);
            --sc-border: #2a3d52;
            --sc-border-highlight: #4a6d8c;

            --sc-text-main: #aaccff;
            --sc-text-dim: #557799;
            --sc-accent-blue: #00eeff;
            --sc-accent-gold: #ffcc00;
            --sc-accent-red: #ff3333;

            --scanline-color: rgba(0, 20, 40, 0.3);
        }

        body,
        html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            overflow: hidden;
            /* 全局默认使用终端字体，避免出现“正常”文字 */
            font-family: 'Share Tech Mono', monospace;
            color: var(--sc-text-main);
            user-select: none;
            font-size: 16px;
            /* 基础字号稍微调大 */
        }

        /* --- 背景纹理与特效 --- */
        .grid-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(rgba(18, 50, 80, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(18, 50, 80, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            pointer-events: none;
            z-index: 0;
        }

        .vignette {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, transparent 50%, rgba(0, 0, 0, 0.8) 100%);
            pointer-events: none;
            z-index: 90;
        }

        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 0),
                    rgba(255, 255, 255, 0) 50%,
                    var(--scanline-color) 50%,
                    var(--scanline-color));
            background-size: 100% 3px;
            pointer-events: none;
            z-index: 91;
            opacity: 0.6;
        }

        /* --- 布局容器 --- */
        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: 380px 1fr 380px;
            grid-template-rows: 70px 1fr 50px;
            pointer-events: none;
            z-index: 100;
            box-sizing: border-box;
        }

        .pointer-active {
            pointer-events: auto;
        }

        /* --- 通用泰伦面板样式 --- */
        .terran-panel {
            background: var(--sc-panel-bg);
            border: 1px solid var(--sc-border);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5), inset 0 0 20px rgba(0, 20, 40, 0.5);
            position: relative;
            /* 切角效果 */
            clip-path: polygon(0 10px, 10px 0,
                    100% 0, 100% calc(100% - 10px),
                    calc(100% - 10px) 100%, 0 100%);
            backdrop-filter: blur(5px);
        }

        .terran-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 1px solid transparent;
            /* 角落高亮装饰 */
            background:
                linear-gradient(135deg, var(--sc-border-highlight) 5px, transparent 5px) top left,
                linear-gradient(-135deg, var(--sc-border-highlight) 5px, transparent 5px) bottom right;
            background-size: 15px 15px;
            background-repeat: no-repeat;
            pointer-events: none;
            z-index: 2;
        }

        /* --- 顶部导航栏 --- */
        header {
            grid-column: 1 / -1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            background: linear-gradient(90deg, rgba(5, 8, 12, 0.9) 0%, rgba(20, 30, 45, 0.8) 50%, rgba(5, 8, 12, 0.9) 100%);
            border-bottom: 2px solid var(--sc-border-highlight);
            clip-path: polygon(0 0, 100% 0, 100% 70%, calc(100% - 20px) 100%, 20px 100%, 0 70%);
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            /* 标题保持 Orbitron */
            font-size: 26px;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin: 0;
            color: var(--sc-text-main);
            text-shadow: 0 0 10px var(--sc-accent-blue);
        }

        .status-bar {
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            color: var(--sc-accent-gold);
            display: flex;
            gap: 30px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* --- 左侧面板：行星列表 --- */
        .left-panel {
            grid-row: 2;
            grid-column: 1;
            display: flex;
            flex-direction: column;
            padding: 2px;
            margin-left: 10px;
            margin-right: 10px;
            margin-top: 10px;
            transform: translateX(0);
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            /* 关键！锁死Grid内的容器高度，防止内容溢出 */
            overflow: hidden;
            height: calc(100% - 10px);
        }

        .left-panel.hidden {
            transform: translateX(-110%);
        }

        .panel-content-inner {
            padding: 15px;
            height: 100%;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
        }

        .panel-header {
            font-family: 'Orbitron', sans-serif;
            border-bottom: 2px solid var(--sc-border-highlight);
            padding-bottom: 8px;
            margin-bottom: 15px;
            font-size: 16px;
            color: var(--sc-accent-gold);
            text-transform: uppercase;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-header::after {
            content: '///';
            font-size: 12px;
            color: var(--sc-border-highlight);
            letter-spacing: 2px;
        }

        .planet-list {
            overflow-y: auto;
            flex-grow: 1;
            /* 关键！告诉 Flex item 它可以缩小到 0，否则它会以内容高度为准撑破父容器 */
            min-height: 0;
            scrollbar-width: thin;
            scrollbar-color: var(--sc-border-highlight) var(--sc-bg-dark);
            padding-right: 5px;
        }

        .planet-list::-webkit-scrollbar {
            width: 6px;
        }

        .planet-list::-webkit-scrollbar-track {
            background: var(--sc-bg-dark);
        }

        .planet-list::-webkit-scrollbar-thumb {
            background: var(--sc-border-highlight);
            border-radius: 2px;
        }

        .list-item {
            padding: 10px 15px;
            margin-bottom: 6px;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.05) 0%, transparent 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-left: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            /* 确保列表项也是科技字体 */
            font-family: 'Share Tech Mono', monospace;
            font-size: 15px;
            letter-spacing: 0.5px;
            position: relative;
        }

        .list-item:hover {
            background: linear-gradient(90deg, rgba(0, 238, 255, 0.15) 0%, transparent 100%);
            border-color: var(--sc-accent-blue);
            padding-left: 20px;
            box-shadow: 0 0 10px rgba(0, 238, 255, 0.1);
        }

        .list-item.active {
            background: linear-gradient(90deg, rgba(255, 204, 0, 0.2) 0%, transparent 100%);
            border-color: var(--sc-accent-gold);
            border-left: 3px solid var(--sc-accent-gold);
            color: #fff;
            text-shadow: 0 0 5px var(--sc-accent-gold);
        }

        .list-item.star-item {
            color: var(--sc-accent-gold);
            border-bottom: 1px dashed var(--sc-accent-gold);
        }

        /* --- 右侧面板：详细数据 --- */
        .right-panel {
            grid-row: 2;
            grid-column: 3;
            display: flex;
            flex-direction: column;
            margin-left: 10px;
            margin-right: 10px;
            margin-top: 10px;
            transform: translateX(0);
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            height: calc(100% - 10px);
        }

        .right-panel.hidden {
            transform: translateX(110%);
        }

        .wireframe-container {
            width: 100%;
            height: 200px;
            border: 1px solid var(--sc-border-highlight);
            margin-bottom: 20px;
            position: relative;
            background: radial-gradient(circle, rgba(0, 100, 255, 0.1) 0%, rgba(0, 0, 0, 0.5) 80%);
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.8);
        }

        .reticle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 80%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            pointer-events: none;
        }

        .reticle::before,
        .reticle::after {
            content: '';
            position: absolute;
            background: var(--sc-accent-blue);
            opacity: 0.5;
        }

        .reticle::before {
            top: 50%;
            left: 0;
            width: 100%;
            height: 1px;
        }

        .reticle::after {
            left: 50%;
            top: 0;
            height: 100%;
            width: 1px;
        }

        #wireframe-canvas {
            width: 100%;
            height: 100%;
        }

        .data-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .data-block {
            background: rgba(0, 0, 0, 0.3);
            padding: 8px;
            border-left: 2px solid var(--sc-border);
        }

        .data-label {
            color: var(--sc-text-dim);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 2px;
            font-family: 'Share Tech Mono', monospace;
            /* 标签使用 Mono */
        }

        .data-value {
            color: var(--sc-text-main);
            font-size: 16px;
            font-family: 'Orbitron', sans-serif;
            /* 数值保持 Orbitron 以突出 */
            text-shadow: 0 0 2px var(--sc-accent-blue);
        }

        .faction-tag {
            display: inline-block;
            padding: 3px 8px;
            font-size: 12px;
            border: 1px solid;
            margin-top: 4px;
            background: rgba(0, 0, 0, 0.4);
            text-transform: uppercase;
            font-weight: bold;
            font-family: 'Share Tech Mono', monospace;
        }

        .desc-box {
            font-size: 14px;
            /* 稍微加大 */
            line-height: 1.5;
            color: #ccc;
            margin-top: 15px;
            height: 120px;
            overflow-y: auto;
            border-top: 1px solid var(--sc-border);
            padding-top: 10px;
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.2) 0%, transparent 100%);
            /* 关键：确保描述文字也是科技字体 */
            font-family: 'Share Tech Mono', monospace;
        }

        /* --- 底部状态栏 --- */
        footer {
            grid-column: 1 / -1;
            grid-row: 3;
            background: rgba(5, 8, 12, 0.9);
            border-top: 2px solid var(--sc-border-highlight);
            display: flex;
            align-items: center;
            padding: 0 30px;
            font-size: 12px;
            color: var(--sc-text-dim);
            justify-content: space-between;
            font-family: 'Orbitron', sans-serif;
            clip-path: polygon(20px 0, calc(100% - 20px) 0, 100% 100%, 0 100%);
        }

        .cmd-line {
            color: var(--sc-accent-blue);
            animation: blink 1s step-end infinite;
        }

        .hint-overlay {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--sc-accent-blue);
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            letter-spacing: 2px;
            text-shadow: 0 0 10px var(--sc-accent-blue);
            opacity: 0;
            transition: opacity 0.5s;
            pointer-events: none;
            background: rgba(5, 10, 20, 0.8);
            padding: 8px 20px;
            border: 1px solid var(--sc-accent-blue);
            border-radius: 20px;
        }

        .hint-overlay.visible {
            opacity: 1;
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }

        #starmap {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
            /* 强制占满，无论 JS 是否慢了一拍 */
            width: 100%;
            height: 100%;
            display: block;
            /* 防止 canvas 默认 inline 带来的 3px 缝隙 */
        }

        /* 阵营颜色覆盖 */
        .color-dominion {
            color: #ff5555 !important;
            border-color: #ff5555 !important;
        }

        .color-zerg {
            color: #cc55ff !important;
            border-color: #cc55ff !important;
        }

        .color-protoss {
            color: #ffff55 !important;
            border-color: #ffff55 !important;
        }

        .color-kelmorian {
            color: #ffaa00 !important;
            border-color: #ffaa00 !important;
        }

        .color-umojan {
            color: #00ffff !important;
            border-color: #00ffff !important;
        }

        .color-neutral {
            color: #cccccc !important;
            border-color: #cccccc !important;
        }
    </style>
</head>

<body>

    <div class="grid-overlay"></div>
    <div class="vignette"></div>
    <div class="scanlines"></div>

    <div id="ui-layer">
        <header>
            <h1><span style="color:var(--sc-accent-gold)">UNN</span> TACTICAL <span
                    style="font-size:12px; color:var(--sc-text-dim); vertical-align:middle">V3.1 CONSISTENCY</span></h1>
            <div class="status-bar">
                <span><span style="color:var(--sc-text-dim)">SYSTEM:</span> ONLINE</span>
                <span><span style="color:var(--sc-text-dim)">NET:</span> SECURE</span>
                <span style="color:var(--sc-accent-red)">ALERT: ZERG DETECTED</span>
            </div>
        </header>

        <!-- 左侧面板 -->
        <div class="left-panel terran-panel pointer-active" id="left-panel">
            <div class="panel-content-inner">
                <div class="panel-header">Detected Signatures</div>
                <div class="planet-list" id="planet-list-container"></div>
            </div>
        </div>

        <!-- 右侧面板 -->
        <div class="right-panel terran-panel pointer-active" id="right-panel">
            <div class="panel-content-inner">
                <div class="panel-header">Planetary Analysis</div>

                <div class="wireframe-container">
                    <div class="reticle"></div>
                    <canvas id="wireframe-canvas"></canvas>
                    <div
                        style="position:absolute; bottom:5px; right:5px; font-size:9px; color:var(--sc-accent-blue); font-family:'Orbitron'">
                        SCANNING...</div>
                </div>

                <div id="planet-details">
                    <div class="data-block" style="margin-bottom:10px">
                        <div class="data-label">Designation</div>
                        <div class="data-value" id="detail-name" style="font-size:18px">SCANNING...</div>
                        <div class="data-value" id="detail-faction" style="margin-top:5px; font-size:12px">-</div>
                    </div>

                    <div class="data-grid">
                        <div class="data-block">
                            <div class="data-label">Status</div>
                            <div class="data-value" id="detail-status" style="font-size:12px">-</div>
                        </div>
                        <div class="data-block">
                            <div class="data-label">Population</div>
                            <div class="data-value" id="detail-population"
                                style="color:var(--sc-accent-gold); font-size:12px">-</div>
                        </div>
                        <div class="data-block">
                            <div class="data-label">Gravity</div>
                            <div class="data-value" id="detail-gravity">-</div>
                        </div>
                        <div class="data-block">
                            <div class="data-label">Rotation</div>
                            <div class="data-value" id="detail-period">-</div>
                        </div>
                    </div>

                    <div class="data-block" id="mission-block"
                        style="display:none; margin-bottom:10px; border-left-color:var(--sc-accent-blue);">
                        <div class="data-label">Mission / Campaign</div>
                        <div class="data-value" id="detail-mission"
                            style="font-size:11px; color:var(--sc-accent-blue);">-</div>
                    </div>

                    <div class="data-block">
                        <div class="data-label">Atmosphere</div>
                        <div class="data-value" id="detail-atmo" style="font-size:12px">-</div>
                    </div>

                    <div class="desc-box" id="detail-desc">
                        Initializing query... Awaiting input.
                    </div>
                </div>
            </div>
        </div>

        <div class="hint-overlay" id="hint-text">SELECT TARGET // DBL-CLICK TO ENGAGE</div>

        <footer>
            <div>COORDINATES: <span id="mouse-coords" style="color:var(--sc-accent-blue)">000.00, 000.00</span></div>
            <div><span class="cmd-line">>_ READY</span></div>
        </footer>
    </div>

    <canvas id="starmap"></canvas>

    <script>
        /**
         * 行星数据 V2.3 (Preserved)
         */
        const planets = [
            // --- 1. 泰伦帝国核心区 (Terran Core) ---
            {
                id: 'korhal',
                name: '克哈 IV (Korhal IV)',
                x: 450, y: 350,
                faction: 'Terran Dominion',
                color: '#ff4444',
                status: '首都 / 核心中枢',
                mission: '全战役系列主线',
                desc: '帝国首都与权力核心。曾被旧联邦核弹彻底毁灭变为辐射废土，现已重建为覆盖整个地表的巨大钢铁都市，充斥着霓虹灯、全息广告与高耸的帝国宣传塔，是皇权的绝对象征。',
                size: 12, gravity: '1.00 g (标准)', period: '24 小时', atmo: '氮氧 (需过滤)', pop: '65 亿 (人类)'
            },
            {
                id: 'dylar',
                name: '迪拉 IV (Dylar IV)',
                x: 520, y: 320,
                faction: 'Terran Dominion',
                color: '#ff6666',
                status: '核心船坞',
                mission: '自由之翼: 强行夺取',
                desc: '帝国舰队的主要生产基地与工业枢纽。其轨道上密布着巨大的船坞设施，是星区大多数战列巡洋舰的摇篮；雷诺游骑兵曾大胆潜入此地，偷走了传奇旗舰“休伯利安号”。',
                size: 9, gravity: '0.95 g', period: '26 小时', atmo: '工业烟雾', pop: '9 亿 (人类)'
            },
            {
                id: 'umoja',
                name: '尤摩杨 (Umoja)',
                x: 350, y: 350,
                faction: 'Umojan Protectorate',
                color: '#00ffff',
                status: '独立 / 中立',
                mission: '虫群之心: 实验室序章',
                desc: '护国军首都与科技乌托邦。星区中最干净、体面的人类星球，以优雅的白色流线型建筑闻名；这里将尖端科技与生态完美结合，远离帝国暴政，是理性与进步的象征。',
                size: 10, gravity: '1.00 g (标准)', period: '24.5 小时', atmo: '氮氧 (纯净)', pop: '21 亿 (人类)'
            },
            {
                id: 'tyrador',
                name: '泰拉多尔 IX (Tyrador IX)',
                x: 420, y: 280,
                faction: 'Dominion',
                color: '#00ddaa',
                status: '旅游胜地',
                mission: '诺娃隐秘行动: 坚守',
                desc: '著名的度假星球与商业中心。拥有繁华的都市和优美的海滨，但没有任何重型防御工事，因此在异虫入侵时遭受了重创。',
                size: 10, gravity: '1.00 g (标准)', period: '24 小时', atmo: '人工温控 (宜人)', pop: '高 (游客)'
            },
            {
                id: 'antiga',
                name: '安提加主星 (Antiga Prime)',
                x: 550, y: 420,
                faction: 'Destroyed',
                color: '#555555',
                status: '已毁灭',
                mission: '自由之翼: 爆发 / 诺娃行动',
                desc: '已彻底毁灭的死寂世界。曾是反抗联邦的起义地，凯瑞甘在此安放灵能发射器引发异虫屠杀，最终迫使星灵舰队将其“玻璃化”，是人类内战残酷性的见证。',
                size: 6, gravity: '1.00 g', period: '24 小时', atmo: '无 / 真空', pop: '0 (已灭绝)'
            },

            // --- 2. 工业与边境带 (Industrial & Border) ---
            {
                id: 'moria',
                name: '莫里亚 (Moria)',
                x: 380, y: 500,
                faction: 'Kel-Morian',
                color: '#ffaa00',
                status: '工业枢纽',
                mission: '背景主星 / 设定提及',
                desc: '凯莫瑞安联合体总部。巨大的露天矿坑与重工业设施覆盖地表，空气污浊充满酸雨，是一个唯利是图、装备比人命更值钱的贪婪世界。',
                size: 11, gravity: '1.02 g', period: '23 小时', atmo: '重度污染', pop: '48 亿 (人类)'
            },
            {
                id: 'redstone',
                name: '红石星 (Redstone III)',
                x: 410, y: 550,
                faction: 'Kel-Morian',
                color: '#cc8800',
                status: '极不稳定',
                mission: '自由之翼: 恶魔乐园',
                desc: '地质极不稳定的火山行星，盛产高能晶体矿。熔岩潮汐会定期淹没低地，矿工必须像赌徒一样在岩浆涨落的间隙拼命开采，稍有不慎便尸骨无存。',
                size: 7, gravity: '0.88 g', period: '16 小时', atmo: '火山气体', pop: '3.5 万 (承包商)'
            },
            {
                id: 'marsara',
                name: '玛萨拉 (Mar Sara)',
                x: 480, y: 580,
                faction: 'Contested (Dominion)',
                color: '#ff8844',
                status: '资源开采中',
                mission: '自由之翼: 零号时刻',
                desc: '边境荒地与反抗军的摇篮。吉姆·雷诺曾在此担任治安官，曾被异虫感染后遭星灵净化玻璃化，如今已重新地球化；这里不仅是萨尔那加神器的挖掘地，也是整个大战争序幕拉开的地方。',
                size: 8, gravity: '0.98 g', period: '24 小时', atmo: '氮氧 (地球化)', pop: '8 万 (殖民者)'
            },
            {
                id: 'tarsonis',
                name: '塔桑尼斯 (Tarsonis)',
                x: 600, y: 500,
                faction: 'Feral Zerg',
                color: '#884488',
                status: '完全感染',
                mission: '诺娃隐秘行动 / 背景重地',
                desc: '旧联邦首都的墓碑。曾是繁华的超级都市，因蒙斯克投放灵能发射器引来异虫而毁灭，现已成为长满菌毯和虫巢的巨大废墟；这里见证了联邦的覆灭，也是凯瑞甘被遗弃并转化为刀锋女王的悲剧之地。',
                size: 10, gravity: '1.00 g (标准)', period: '27 小时', atmo: '异虫孢子 / 氮气', pop: '数十亿 (野生异虫)'
            },

            // --- 3. 异虫主巢区 (The Swarm) ---
            {
                id: 'char',
                name: '查尔 (Char)',
                x: 700, y: 650,
                faction: 'Zerg Swarm',
                color: '#aa00ff',
                status: '主巢 / 炼狱',
                mission: '自由之翼 & 虫群之心: 核心战场',
                desc: '异虫大本营。充满火山灰、岩浆河与酸性大气的地狱，地底布满无穷无尽的虫道；这里是刀锋女王的王座所在地，也是科普卢星区最危险的坐标。极高的重力筛选出了最强壮的虫群基因。',
                size: 13, gravity: '高重力 (1.35 g)', period: '52 小时', atmo: '灰烬 / 酸性', pop: '>100 亿 (异虫)'
            },
            {
                id: 'phaeton',
                name: '法厄同 (Phaeton)',
                x: 750, y: 720,
                faction: 'Zerg Swarm',
                color: '#aa5500',
                status: '进化猎场',
                mission: '虫群之心: 蟑螂进化',
                desc: '拥有独特生态的荒漠星球。这里的生物进化出了极强的再生能力，异虫曾在此猎杀当地物种，将这种基因同化到了蟑螂体内。',
                size: 10, gravity: '1.02 g', period: '26 小时', atmo: '炎热 / 干燥', pop: '野生异虫'
            },
            {
                id: 'cavir',
                name: '卡维尔 (Cavir)',
                x: 650, y: 700,
                faction: 'Zerg Swarm',
                color: '#00aa00',
                status: '生化实验',
                mission: '虫群之心: 爆虫进化',
                desc: '充满剧毒植物的丛林。是爆虫进化的关键地点，凯瑞甘在此让爆虫通过同化当地剧毒生物，获得了毁灭性的酸液强化。',
                size: 9, gravity: '1.00 g (标准)', period: '22 小时', atmo: '剧毒孢子', pop: '野生异虫'
            },

            // --- 4. 星灵领地 (Protoss Space) ---
            {
                id: 'aiur',
                name: '艾尔 (Aiur)',
                x: 900, y: 300,
                faction: 'Protoss Daelaam',
                color: '#ffff00',
                status: '重建中',
                mission: '虚空之遗: 核心战场',
                desc: '神圣的星灵母星。曾拥有金色的高塔与完美的灵能网络，一度沦陷于异虫主宰之手并布满菌毯；虽然达拉姆星灵最终收复了家园，但清理地下庞大的虫群仍需数百年。',
                size: 15, gravity: '1.05 g', period: '20 小时', atmo: '氮氧 (富含灵能)', pop: '35 亿 (星灵/异虫)'
            },
            {
                id: 'shakuras',
                name: '萨古拉斯 (Shakuras)',
                x: 960, y: 250,
                faction: 'Destroyed',
                color: '#666644',
                status: '已炸毁',
                mission: '虚空之遗: 最后一战',
                desc: '已化为尘埃。曾是奈拉齐姆的永夜避难所，依靠星光与水晶阵列照明；为了彻底消灭埃蒙的混元体大军，阿塔尼斯过载了萨尔那加神庙，悲壮地引爆了整颗星球。',
                size: 0, debris: true, gravity: '0 g', period: '无', atmo: '真空', pop: '0 (已撤离)'
            },
            {
                id: 'endion',
                name: '恩迪昂 (Endion)',
                x: 880, y: 220,
                faction: 'Protoss Daelaam',
                color: '#ffff00',
                status: '控制中',
                mission: '虚空之遗: 净化者觉醒',
                desc: '森林卫星。其轨道上运行着巨大的空间站“赛博罗斯”，封印着古代净化者大军；阿塔尼斯曾在此解除了封印，唤醒了这些拥有机械人格的战士以对抗埃蒙。',
                size: 7, gravity: '0.70 g', period: '12 小时', atmo: '氮氧 (森林)', pop: '绝密'
            },
            {
                id: 'slayn',
                name: '斯雷恩 (Slayn)',
                x: 940, y: 150,
                faction: 'Abandoned',
                color: '#aa0044',
                status: '废弃',
                mission: '虚空之遗: 拉克希尔仪式',
                desc: '塔达林的旧母星。充满了致幻的地嗪毒气、猛烈的雷暴与无底深渊的黑暗世界；曾是残酷权力决斗“拉克希尔”的举办地，随着死亡舰队的离去，现已被遗弃。',
                size: 9, gravity: '0.85 g', period: '未知', atmo: '地嗪毒气', pop: '极少 (塔达林)'
            },

            // --- 5. 远东/深空：考古与虚空 (Deep Space / Archaeology) ---
            {
                id: 'ulnar',
                name: '乌尔纳 (Ulnar)',
                x: 650, y: 100,
                faction: 'Xel\'Naga',
                color: '#00ff00',
                status: '休眠 / 虚空裂隙',
                mission: '虚空之遗: 乌尔纳神庙',
                desc: '萨尔那加的沉睡之地。位于现实与虚空夹缝中的巨型人造天体，这里不遵循物理法则，不仅是揭开创世真相的圣地，也是星灵与异虫被迫结盟的转折点。',
                size: 15, special: true, gravity: '变量', period: '无', atmo: '无菌 / 虚空', pop: '0 (休眠)'
            },
            {
                id: 'ulaan',
                name: '乌兰 (Ulaan)',
                x: 1050, y: 120,
                faction: 'Xel\'Naga',
                color: '#aa88ff',
                status: '预言圣地',
                mission: '自由之翼: 泽拉图记忆',
                desc: '破碎的深渊。萨尔那加的预言圣地，地表布满巨大的裂隙和古老的石刻壁画。泽拉图在此遭遇了凯瑞甘，并发现了关于“大吞噬者”的预言碎片。',
                size: 10, gravity: '0.85 g', period: '未知', atmo: '稀薄 / 神秘', pop: '0 (守护者)'
            },
            {
                id: 'zhakul',
                name: '扎库尔 (Zhakul)',
                x: 1000, y: 180,
                faction: 'Protoss (Dark)',
                color: '#4444aa',
                status: '禁忌档案馆',
                mission: '自由之翼: 邪恶转折',
                desc: '永夜的知识库。为了解读乌兰的预言，泽拉图来到这里寻找不朽的“保存者”。这里曾被混合体马尔（Maar）占领并囚禁了守护者，是泽拉图揭开谜底的关键一站。',
                size: 9, gravity: '1.00 g (标准)', period: '无 (永夜)', atmo: '人工维持', pop: '保存者'
            },
            {
                id: 'glacius',
                name: '格拉修斯 (Glacius)',
                x: 880, y: 120,
                faction: 'Protoss (Purifier)',
                color: '#00ccff',
                status: '已瓦解',
                mission: '虚空之遗: 禁忌武器',
                desc: '被冰封的古代科技库。存放着被封印的净化者科技和原型机，阿塔尼斯在塔达林的轨道轰炸摧毁地表设施前一刻，惊险地抢救出了珍贵的数据。',
                size: 9, gravity: '1.05 g', period: '32 小时', atmo: '极寒 / 风暴', pop: '哨兵机械'
            },

            // --- 6. 远南/蛮荒：原始与进化 (Wild Space) ---
            {
                id: 'zerus',
                name: '泽鲁斯 (Zerus)',
                x: 1000, y: 750,
                faction: 'Primal Zerg',
                color: '#aa00ff',
                status: '原始进化',
                mission: '虫群之心: 原生异虫',
                desc: '异虫发源地。原始、野性且充满敌意的丛林世界，这里的生物不属于主巢心智，只信奉“适者生存”；凯瑞甘曾在此投入原始分裂池，重生为拥有原始力量的刀锋女王。',
                size: 12, gravity: '1.20 g', period: '25 小时', atmo: '富氧 / 原始', pop: '无法计数 (原生)'
            },
            {
                id: 'kaldir',
                name: '卡尔迪尔 (Kaldir)',
                x: 900, y: 650,
                faction: 'Zerg Swarm',
                color: '#aa00ff',
                status: '极寒',
                mission: '虫群之心: 冰霜风暴',
                desc: '被冰封的极寒世界。拥有能瞬间冻结一切的“闪聚风暴”，凯瑞甘曾率军在此猎杀当地巨兽以获取抗寒基因，并消灭了驻扎于此的星灵远征军以掩盖虫群的行踪。',
                size: 8, gravity: '1.05 g', period: '30 小时', atmo: '稀薄 / 氮气', pop: '高 (异虫)'
            },
            {
                id: 'belsher',
                name: '拜舍尔 (Bel\'Shir)',
                x: 850, y: 550,
                faction: 'Contested',
                color: '#aa0044',
                status: '地嗪资源点',
                mission: '自由之翼: 欢迎来到丛林',
                desc: '被热带雨林覆盖的潮湿星球。盛产珍贵的“造物主之息”（地嗪），曾是塔达林誓死守护的圣地，也是凯瑞甘为了强化虫群灵能而进行血腥掠夺的猎场。',
                size: 8, gravity: '1.01 g', period: '22 小时', atmo: '潮湿 / 地嗪', pop: '未知'
            },
            {
                id: 'haven',
                name: '海文 (Haven)',
                x: 800, y: 480,
                faction: 'Neutral',
                color: '#20f866',
                status: '难民安置点',
                mission: '自由之翼: 海文星抉择',
                desc: '风景优美的乐园世界，位于星灵领地边缘。因环境类似地球而成为饱受战火摧残的难民的避难所，曾因异虫病毒爆发险些被星灵舰队“净化”，是一块脆弱的和平之地。',
                size: 9, gravity: '0.99 g', period: '24 小时', atmo: '氮氧 (宜居)', pop: '1.4 万 (难民)'
            },

            // --- 7. 西部外环：隐秘行动与法外之地 (The Fringe / Covert Ops) ---
            {
                id: 'newfolsom',
                name: '新福尔松 (New Folsom)',
                x: 200, y: 600,
                faction: 'Terran Dominion',
                color: '#cc3333',
                status: '监狱行星',
                mission: '自由之翼: 越狱',
                desc: '熔岩炼狱般的超级监狱。地表流淌着不稳定的岩浆，专门关押被帝国视为“精神不稳定”的幽魂特工与重刑犯，只有进没有出，直到雷诺与托什策划了一场惊天劫狱释放了囚犯。',
                size: 7, gravity: '1.10 g', period: '18 小时', atmo: '硫磺 / 灰烬', pop: '45 万 (囚犯)'
            },
            {
                id: 'deadman',
                name: '亡者之港 (Deadman\'s Port)',
                x: 150, y: 500,
                faction: 'Mercenaries',
                color: '#cccccc',
                status: '黑市活跃',
                mission: '自由之翼: 割喉战',
                desc: '建立在废弃空间平台与小行星上的法外之地。这里是亡命徒、雇佣兵与黑市商人的天堂，由米拉·汉统治，全星区最大的销赃窝点，雷诺游骑兵甚至在此遭遇过“强制婚姻”。',
                size: 5, gravity: '人工重力', period: '无', atmo: '生命维持系统', pop: '120 万 (混居)'
            },
            {
                id: 'shiloh',
                name: '夏伊洛 (Shiloh)',
                x: 180, y: 450,
                faction: 'Terran Fringe',
                color: '#aaaa88',
                status: '边缘农业',
                mission: '背景故事 / 小说设定',
                desc: '吉姆·雷诺的出生地与真正的故乡。一个宁静但贫瘠的农业世界，远离核心世界的喧嚣与政治；这里的人民坚韧不拔，习惯了自给自足的生活，也是雷诺"草根英雄"性格的起源地。',
                size: 9, gravity: '0.98 g', period: '23 小时', atmo: '干燥 / 多尘', pop: '少 (农民)'
            },
            {
                id: 'agria',
                name: '阿格瑞亚 (Agria)',
                x: 220, y: 400,
                faction: 'Neutral',
                color: '#44aa44',
                status: '农业殖民地',
                mission: '自由之翼: 大撤离',
                desc: '艾瑞尔·汉森博士的家园。一个以高科技农业为主的平静世界，但在异虫全面入侵时沦为屠宰场，是雷诺游骑兵介入难民救援行动的主要地点。',
                size: 10, gravity: '1.00 g (标准)', period: '26 小时', atmo: '氮氧 (农业)', pop: '撤离中'
            },
            {
                id: 'meinhoff',
                name: '梅恩霍夫 (Meinhoff)',
                x: 240, y: 480,
                faction: 'Infested',
                color: '#663366',
                status: '生化危机',
                mission: '自由之翼: 感染爆发',
                desc: '被异虫病毒吞噬的难民营。白昼看似正常，夜晚则会被从地底钻出的无数受感染人类淹没，雷诺曾在此目睹了人类被转化为行尸走肉的惨状。',
                size: 9, gravity: '0.98 g', period: '24 小时', atmo: '严重污染', pop: '99% 已感染'
            },

            // --- 8. 西北外环：机密与诺娃行动 (Secret / Nova Ops) ---
            {
                id: 'braxis',
                name: '布拉克西斯 (Braxis)',
                x: 150, y: 250,
                faction: 'Terran Dominion',
                color: '#ff6666',
                status: '军事重镇',
                mission: '星际1 / 合作任务',
                desc: '被冰雪覆盖的严寒要塞，前身为星灵殖民地“凯塔”。后被泰伦帝国改造成进行秘密实验的军事重镇，地球联合理事会（UED）曾将其作为入侵星区的关键突破口。',
                size: 8, gravity: '1.15 g', period: '29 小时', atmo: '寒冷 / 氮氧', pop: '2.5 万 (驻军)'
            },
            {
                id: 'borea',
                name: '波利亚 (Borea)',
                x: 100, y: 200,
                faction: 'Dominion / Separatist',
                color: '#aaddff',
                status: '极寒边境',
                mission: '诺娃隐秘行动: 逃亡',
                desc: '隐秘的冰封世界。这里有帝国废弃的绝密研究设施，诺娃从这里醒来并逃离，也是抵抗野生异虫入侵的第一线。',
                size: 8, gravity: '1.00 g (标准)', period: '22 小时', atmo: '极寒 / 暴雪', pop: '绝密'
            },
            {
                id: 'castanar',
                name: '卡斯塔纳 (Castanar)',
                x: 250, y: 200,
                faction: 'Dominion (Secret)',
                color: '#333333',
                status: '机密设施',
                mission: '自由之翼: 揭露黑幕',
                desc: '帝国的黑暗心脏。表面是普通的研究站，地下却隐藏着骇人听闻的混合体实验室；雷诺在此揭露了蒙斯克试图制造人造怪物的惊天丑闻。',
                size: 8, gravity: '1.00 g (标准)', period: '24 小时', atmo: '人工控制', pop: '绝密'
            },
            {
                id: 'avernus',
                name: '阿弗纳斯 (Avernus)',
                x: 280, y: 280,
                faction: 'Dominion',
                color: '#550000',
                status: '幽灵学院',
                mission: '自由之翼: 幽灵一击',
                desc: '幽灵特工的摇篮。设有高度设防的幽灵军校和战术核武器库，托什与雷诺曾突袭此地，彻底终结了“幽魂”计划并释放了被洗脑的特工。',
                size: 6, gravity: '0.95 g', period: '20 小时', atmo: '城市 / 军事', pop: '军校教员'
            },
            {
                id: 'vardona',
                name: '瓦多纳 (Vardona)',
                x: 180, y: 150,
                faction: 'Defenders of Man',
                color: '#aaaaaa',
                status: '叛军总部',
                mission: '诺娃隐秘行动: 终局',
                desc: '繁荣的都市星球，戴维斯将军的大本营。表面上是帝国的模范城市，实则是“人类保卫者”策划叛乱的核心，也是巨型机甲“科桑索斯” (Xanthos) 的决战之地。',
                size: 12, gravity: '1.00 g (标准)', period: '24 小时', atmo: '城市 / 雾霾', pop: '数十亿'
            },
            {
                id: 'jarban',
                name: '加尔班 (Jarban Minor)',
                x: 120, y: 650,
                faction: 'Unknown',
                color: '#448844',
                status: '野生丛林',
                mission: '诺娃隐秘行动: 敌方情报',
                desc: '被遗忘的殖民地。地表覆盖着茂密的丛林和沼泽，是野生异虫滋生的温床，诺娃在此执行了危险的灵能信标摧毁任务。',
                size: 9, gravity: '1.10 g', period: '26 小时', atmo: '潮湿 / 孢子', pop: '野生'
            },
            {
                id: 'veridia',
                name: '维利迪亚主星 (Veridia Prime)',
                x: 250, y: 700,
                faction: 'Kel-Morian',
                color: '#ff6600',
                status: '岩浆开采',
                mission: '诺娃隐秘行动: 爆发点',
                desc: '地质极不稳定的矿业星球。地表大部分被熔岩覆盖，托什曾协助诺娃在此抢夺高能瓦斯资源，由于环境恶劣，必须不断移动基地以防被岩浆吞没。',
                size: 11, gravity: '0.95 g', period: '18 小时', atmo: '火山灰', pop: '矿工'
            },

            // --- 9. 邪恶与混合体 (The Dark Corner) ---
            {
                id: 'atrias',
                name: '阿特里亚斯 (Atrias)',
                x: 80, y: 100,
                faction: 'Moebius / Hybrid',
                color: '#ff0000',
                status: '邪神苏醒',
                mission: '虚空之遗序章: 湮灭低语',
                desc: '湮灭的序曲。位于西格玛象限的边缘世界，莫比斯军团在此利用地嗪复活埃蒙的宿主。泽拉图在此发现了埃蒙复活的真相，并获得了萨尔那加神庙（乌尔纳）的坐标。',
                size: 11, gravity: '1.10 g', period: '26 小时', atmo: '地嗪迷雾', pop: '敌对势力'
            },
            {
                id: 'skygeirr',
                name: '斯盖格尔空间站 (Skygeirr)',
                x: 150, y: 80,
                faction: 'Hybrid / Moebius',
                color: '#444444',
                status: '混合体培育',
                mission: '虫群之心: 虚空幻影',
                desc: '这就不是星球，而是建立在巨大死星残骸上的超级实验室。纳鲁德博士在此培育终极混合体，斯图科夫在此复仇并将其彻底摧毁。',
                size: 5, gravity: '人工重力', period: '无', atmo: '生命维持', pop: '莫比斯 / 混合体'
            },
            {
                id: 'revanscar',
                name: '雷文斯卡 (Revanscar)',
                x: 220, y: 80,
                faction: 'Moebius Corps',
                color: '#222222',
                status: '最后防线',
                mission: '虚空之遗: 圣堂武士出击',
                desc: '莫比斯军团的最后据点。阿塔尼斯与凯瑞甘曾联手攻击此地，摧毁了为埃蒙生产混合体的设施，终结了莫比斯军团的疯狂。',
                size: 8, gravity: '1.00 g (标准)', period: '24 小时', atmo: '工业 / 黑暗', pop: '敌对势力'
            },
            {
                id: 'xil',
                name: '席尔 (Xil)',
                x: 280, y: 120,
                faction: 'Moebius/Tal\'darim',
                color: '#ccaa00',
                status: '遗迹挖掘',
                mission: '自由之翼: 挖掘行动',
                desc: '萨尔那加神庙遗址。拥有一座巨大的古老神庙和危险的防御机制，塔达林曾在此死守，雷诺不得不征用巨大的“德拉肯”激光钻机强行攻破大门。',
                size: 11, gravity: '1.10 g', period: '28 小时', atmo: '干燥 / 沙尘', pop: '远征队'
            },
            {
                id: 'typhon',
                name: '泰丰 (Typhon)',
                x: 320, y: 150,
                faction: 'Unstable',
                color: '#ff2200',
                status: '即将毁灭',
                mission: '自由之翼: 超新星',
                desc: '处于超新星爆发边缘的危险世界。恒星的剧烈活动周期性地产生火风暴烧毁地表，雷诺游骑兵曾在此进行了一场与时间赛跑的夺宝行动，随后该星系彻底湮灭。',
                size: 7, gravity: '0.90 g', period: '14 小时', atmo: '过热等离子体', pop: '0'
            },
            {
                id: 'chausara',
                name: '乔·萨拉 (Chau Sara)',
                x: 480, y: 650,
                faction: 'Destroyed',
                color: '#555555',
                status: '已净化',
                mission: '星际1: 序幕',
                desc: '大战争的序幕。人类官方记录中首个被异虫完全吞噬的星球，随后被塔萨达尔率领的星灵舰队彻底“玻璃化”，标志着人类首次意识到外星威胁的恐怖。',
                size: 8, gravity: '1.00 g (标准)', period: '24 小时', atmo: '无 / 真空', pop: '0 (已灭绝)'
            }
        ];
        // --- 主星图 Canvas 设置 ---
        const canvas = document.getElementById('starmap');
        const ctx = canvas.getContext('2d');
        const leftPanel = document.getElementById('left-panel');
        const rightPanel = document.getElementById('right-panel');
        const hintText = document.getElementById('hint-text');

        let width, height;
        let camera = { x: 500, y: 500, zoom: 0.8 };
        let targetCamera = { x: 500, y: 500, zoom: 0.8 };
        let isDragging = false;
        let dragStart = { x: 0, y: 0 };
        let lastMouse = { x: 0, y: 0 };
        let hoveredPlanet = null;
        let selectedPlanet = null;

        // --- 星空背景粒子 ---
        const stars = [];
        const numStars = 400;

        function init() {
            resize();
            window.addEventListener('resize', resize);

            for (let i = 0; i < numStars; i++) {
                stars.push({
                    x: Math.random() * 2000 - 500,
                    y: Math.random() * 1500 - 250,
                    size: Math.random() * 2,
                    brightness: Math.random(),
                    flickerSpeed: Math.random() * 0.05
                });
            }

            renderPlanetList();
            requestAnimationFrame(animate);

            canvas.addEventListener('mousedown', e => {
                isDragging = true;
                dragStart = { x: e.clientX, y: e.clientY };
                lastMouse = { x: e.clientX, y: e.clientY };
            });

            window.addEventListener('mouseup', e => {
                if (!isDragging) return;
                isDragging = false;
                const dist = Math.hypot(e.clientX - dragStart.x, e.clientY - dragStart.y);
                if (dist < 5) handleCanvasClick(e.clientX, e.clientY);
            });

            canvas.addEventListener('dblclick', e => {
                const rect = canvas.getBoundingClientRect();
                const mouseX = (e.clientX - rect.left - width / 2) / camera.zoom + camera.x;
                const mouseY = (e.clientY - rect.top - height / 2) / camera.zoom + camera.y;

                let clickedPlanet = null;
                for (let p of planets) {
                    const hitSize = p.type === 'star' ? p.size + 25 : p.size + 15;
                    const dist = Math.hypot(p.x - mouseX, p.y - mouseY);
                    if (dist < hitSize) {
                        clickedPlanet = p;
                        break;
                    }
                }

                if (clickedPlanet) {
                    selectPlanet(clickedPlanet);
                    targetCamera.zoom = 2.5;
                } else {
                    targetCamera.x = mouseX;
                    targetCamera.y = mouseY;
                    targetCamera.zoom = Math.min(targetCamera.zoom * 1.5, 4);
                }
            });

            canvas.addEventListener('mousemove', e => {
                if (isDragging) {
                    const dx = (e.clientX - lastMouse.x) / camera.zoom;
                    const dy = (e.clientY - lastMouse.y) / camera.zoom;
                    targetCamera.x -= dx;
                    targetCamera.y -= dy;
                    lastMouse = { x: e.clientX, y: e.clientY };
                }

                const rect = canvas.getBoundingClientRect();
                const mouseX = (e.clientX - rect.left - width / 2) / camera.zoom + camera.x;
                const mouseY = (e.clientY - rect.top - height / 2) / camera.zoom + camera.y;

                document.getElementById('mouse-coords').innerText = `${mouseX.toFixed(2)}, ${mouseY.toFixed(2)}`;
                checkHover(mouseX, mouseY);
            });

            canvas.addEventListener('wheel', e => {
                e.preventDefault();
                const zoomSpeed = 0.001;
                targetCamera.zoom -= e.deltaY * zoomSpeed;
                targetCamera.zoom = Math.min(Math.max(targetCamera.zoom, 0.4), 4);
            });

            deselectPlanet();
        }

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }

        function renderPlanetList() {
            const list = document.getElementById('planet-list-container');
            list.innerHTML = '';
            planets.forEach(p => {
                const item = document.createElement('div');
                item.className = 'list-item';

                if (p.type === 'star') {
                    item.classList.add('star-item');
                    item.innerHTML = `<span>★ ${p.name}</span><span style="color:#ffcc00">[STAR]</span>`;
                } else {
                    let factionClass = 'color-neutral';
                    if (p.faction.includes('Dominion')) factionClass = 'color-dominion';
                    if (p.faction.includes('Zerg')) factionClass = 'color-zerg';
                    if (p.faction.includes('Protoss')) factionClass = 'color-protoss';
                    if (p.faction.includes('Kel-Morian')) factionClass = 'color-kelmorian';
                    if (p.faction.includes('Umojan')) factionClass = 'color-umojan';

                    item.innerHTML = `<span>${p.name.split('(')[0]}</span><span class="${factionClass}">[${p.faction.substring(0, 3).toUpperCase()}]</span>`;
                }

                item.onclick = (e) => {
                    e.stopPropagation();
                    selectPlanet(p);
                };
                item.id = `list-${p.id}`;
                list.appendChild(item);
            });
        }

        function handleCanvasClick(clientX, clientY) {
            const rect = canvas.getBoundingClientRect();
            const mouseX = (clientX - rect.left - width / 2) / camera.zoom + camera.x;
            const mouseY = (clientY - rect.top - height / 2) / camera.zoom + camera.y;

            let clickedPlanet = null;
            for (let p of planets) {
                const hitSize = p.type === 'star' ? p.size + 25 : p.size + 15;
                const dist = Math.hypot(p.x - mouseX, p.y - mouseY);
                if (dist < hitSize) {
                    clickedPlanet = p;
                    break;
                }
            }

            if (clickedPlanet) {
                selectPlanet(clickedPlanet);
            } else {
                deselectPlanet();
            }
        }

        function selectPlanet(planet) {
            selectedPlanet = planet;

            leftPanel.classList.remove('hidden');
            rightPanel.classList.remove('hidden');
            hintText.classList.remove('visible');

            targetCamera.x = planet.x;
            targetCamera.y = planet.y;
            targetCamera.zoom = planet.type === 'star' ? 1.2 : 1.8;

            document.querySelectorAll('.list-item').forEach(el => el.classList.remove('active'));
            const listItem = document.getElementById(`list-${planet.id}`);
            if (listItem) {
                listItem.classList.add('active');
                // 添加 inline: 'nearest' 极大减少浏览器滚动整个页面的概率
                listItem.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });
            }

            document.getElementById('detail-name').innerText = planet.name;
            // 使用 CSS 变量颜色，这里不再直接用 hex
            document.getElementById('detail-name').style.color = 'var(--sc-text-main)';
            document.getElementById('detail-name').style.textShadow = `0 0 10px ${planet.color}`;

            document.getElementById('detail-faction').innerHTML = `<span class="faction-tag" style="border-color:${planet.color}; color:${planet.color}">${planet.faction}</span>`;
            document.getElementById('detail-status').innerText = planet.status;
            document.getElementById('detail-desc').innerText = planet.desc;

            document.getElementById('detail-gravity').innerText = planet.gravity || 'Unknown';
            document.getElementById('detail-period').innerText = planet.period || 'Unknown';
            document.getElementById('detail-atmo').innerText = planet.atmo || 'Unknown';
            document.getElementById('detail-population').innerText = planet.pop || 'Unknown';

            // 显示 Mission 信息（如果有）
            const missionBlock = document.getElementById('mission-block');
            const missionElement = document.getElementById('detail-mission');
            if (planet.mission) {
                missionElement.innerText = planet.mission;
                missionBlock.style.display = 'block';
            } else {
                missionBlock.style.display = 'none';
            }

            wfColor = planet.color;
        }

        function deselectPlanet() {
            selectedPlanet = null;
            leftPanel.classList.add('hidden');
            rightPanel.classList.add('hidden');
            hintText.classList.add('visible');
            document.querySelectorAll('.list-item').forEach(el => el.classList.remove('active'));

            targetCamera.x = 550;
            targetCamera.y = 450;
            targetCamera.zoom = 0.7;
        }

        function checkHover(mx, my) {
            hoveredPlanet = null;
            canvas.style.cursor = 'default';
            if (isDragging) {
                canvas.style.cursor = 'grabbing';
                return;
            }

            for (let p of planets) {
                const hitSize = p.type === 'star' ? p.size + 20 : p.size + 10;
                const dist = Math.hypot(p.x - mx, p.y - my);
                if (dist < hitSize) {
                    hoveredPlanet = p;
                    canvas.style.cursor = 'pointer';
                    break;
                }
            }
        }

        function animate() {
            camera.x += (targetCamera.x - camera.x) * 0.08;
            camera.y += (targetCamera.y - camera.y) * 0.08;
            camera.zoom += (targetCamera.zoom - camera.zoom) * 0.08;

            // 背景清理使用深空色
            ctx.fillStyle = '#05080c';
            ctx.fillRect(0, 0, width, height);

            ctx.save();
            ctx.translate(width / 2, height / 2);
            ctx.scale(camera.zoom, camera.zoom);
            ctx.translate(-camera.x * 0.5, -camera.y * 0.5);

            // 网格线改为更暗淡的蓝色
            ctx.strokeStyle = 'rgba(42, 61, 82, 0.3)';
            ctx.lineWidth = 1;
            const gridSize = 100;

            ctx.beginPath();
            for (let x = -1000; x < 2000; x += gridSize) {
                ctx.moveTo(x, -1000); ctx.lineTo(x, 2000);
            }
            for (let y = -1000; y < 2000; y += gridSize) {
                ctx.moveTo(-1000, y); ctx.lineTo(2000, y);
            }
            ctx.stroke();
            ctx.restore();

            ctx.save();
            ctx.translate(width / 2, height / 2);
            ctx.translate(-camera.x * 0.2, -camera.y * 0.2);

            stars.forEach(star => {
                ctx.fillStyle = `rgba(255, 255, 255, ${0.5 + Math.sin(Date.now() * star.flickerSpeed) * 0.5})`;
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.restore();

            ctx.save();
            ctx.translate(width / 2, height / 2);
            ctx.scale(camera.zoom, camera.zoom);
            ctx.translate(-camera.x, -camera.y);

            // 航路连接线改为淡青色
            ctx.strokeStyle = 'rgba(0, 238, 255, 0.15)';
            ctx.beginPath();

            ctx.moveTo(400, 400); ctx.lineTo(480, 460);
            ctx.moveTo(400, 400); ctx.lineTo(250, 350);
            ctx.moveTo(400, 400); ctx.lineTo(100, 200);
            ctx.moveTo(300, 550); ctx.lineTo(150, 500);
            ctx.moveTo(420, 620); ctx.lineTo(750, 700);
            ctx.moveTo(800, 250); ctx.lineTo(860, 200);
            ctx.moveTo(800, 250); ctx.lineTo(900, 300);
            ctx.moveTo(750, 700); ctx.lineTo(900, 800);
            ctx.moveTo(750, 700); ctx.lineTo(850, 600);
            ctx.stroke();

            // 渲染行星
            planets.forEach(p => {
                if (p === selectedPlanet) {
                    const ringSize = p.type === 'star' ? p.size * 1.5 : p.size * 2.5;

                    // 选中圈改为金色和青色
                    ctx.strokeStyle = 'rgba(255, 204, 0, 0.6)';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, ringSize, 0, Math.PI * 2);
                    ctx.stroke();

                    const time = Date.now() * 0.002;
                    ctx.strokeStyle = '#00eeff';
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, ringSize + 5, time, time + 1.5);
                    ctx.stroke();
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, ringSize + 5, time + Math.PI, time + Math.PI + 1.5);
                    ctx.stroke();
                }

                if (p.debris) {
                    ctx.fillStyle = p.color;
                    for (let i = 0; i < 5; i++) {
                        ctx.fillRect(p.x + (Math.random() - 0.5) * 20, p.y + (Math.random() - 0.5) * 20, 2, 2);
                    }
                } else {
                    const gradient = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.size * 2);
                    gradient.addColorStop(0, p.color);
                    gradient.addColorStop(1, 'rgba(0,0,0,0)');
                    ctx.fillStyle = gradient;
                    ctx.globalAlpha = 0.6;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size * 2, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.globalAlpha = 1.0;

                    ctx.fillStyle = '#000';
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fill();

                    ctx.strokeStyle = p.color;
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }

                let showLabel = false;
                let opacity = 1.0;

                if (p === selectedPlanet || p === hoveredPlanet) {
                    showLabel = true;
                    opacity = 1.0;
                } else {
                    if (camera.zoom < 0.6) opacity = 0.5;
                    showLabel = true;
                }

                if (showLabel) {
                    ctx.fillStyle = (p === selectedPlanet || p === hoveredPlanet) ? '#fff' : `rgba(170, 204, 255,${opacity * 0.8})`;
                    if (p.type === 'star') ctx.fillStyle = `rgba(255,204,0,${opacity})`;
                    // 字体更改为 Orbitron
                    ctx.font = '12px Orbitron';
                    ctx.fillText(p.name.split('(')[0], p.x + p.size + 8, p.y + 4);
                }
            });

            ctx.restore();

            if (!rightPanel.classList.contains('hidden')) {
                renderWireframe();
            }

            requestAnimationFrame(animate);
        }

        const wfCanvas = document.getElementById('wireframe-canvas');
        const wfCtx = wfCanvas.getContext('2d');
        let wfAngle = 0;
        let wfColor = '#00eeff'; // 默认线框颜色

        function renderWireframe() {
            wfCanvas.width = wfCanvas.clientWidth;
            wfCanvas.height = wfCanvas.clientHeight;
            const cx = wfCanvas.width / 2;
            const cy = wfCanvas.height / 2;
            const radius = 60;

            wfCtx.clearRect(0, 0, wfCanvas.width, wfCanvas.height);
            wfCtx.strokeStyle = wfColor;
            wfCtx.lineWidth = 1;
            // 发光效果
            wfCtx.shadowBlur = 5;
            wfCtx.shadowColor = wfColor;

            wfAngle += 0.01;

            for (let i = 0; i < 8; i++) {
                wfCtx.beginPath();
                const lon = (i * Math.PI) / 4 + wfAngle;
                wfCtx.ellipse(cx, cy, radius * Math.abs(Math.cos(lon)), radius, 0, 0, Math.PI * 2);
                wfCtx.stroke();
            }

            for (let i = 1; i < 6; i++) {
                const lat = (i * Math.PI) / 6 - Math.PI / 2;
                const r = radius * Math.cos(lat);
                const y = cy + radius * Math.sin(lat);

                wfCtx.beginPath();
                wfCtx.moveTo(cx - r, y);
                wfCtx.lineTo(cx + r, y);
                wfCtx.stroke();
            }

            // 扫描光效 - 蓝色
            wfCtx.shadowBlur = 0;
            wfCtx.fillStyle = 'rgba(0, 238, 255, 0.2)';
            wfCtx.fillRect(0, (Date.now() % 2000) / 2000 * wfCanvas.height, wfCanvas.width, 3);
        }

        init();

    </script>
</body>

</html>